<%- include ../../head %>
  <body>
  
    <%- include navbar %>

    <div class="container">
      <div class="row">
        <div class="col-sm-3">
        
        <%- include left %>

        </div>
        <div class="col-sm-9">
          <div class="panel panel-primary">
          <div class="panel-heading">
            <i class="glyphicon glyphicon-bookmark"></i> 課題</div>
          <div class="panel-body">
            <p>Google Chart Toolsを利用して、ramen.jsonのデータを地域ごとに集計してみましょう。</p>


            <p>
              <a href="demo/webapi/exercise19/index.html" target="_blank" class="btn btn-default">
              <i class="glyphicon glyphicon-play"></i> デモ
              </a>
              
                <button type="button" class="btn btn-danger" data-toggle="collapse" data-target="#demo">
              <i class="glyphicon glyphicon-question-sign"></i> 解答例
              </button>
            </p>

<div id="demo" class="collapse out">

<pre class="prettyprint linenums">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;title&gt;&lt;/title&gt;
&lt;link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" /&gt;
&lt;link rel="stylesheet" href="grid-listview.css" /&gt;
&lt;script src="http://code.jquery.com/jquery-1.9.1.min.js"&gt;&lt;/script&gt;
&lt;script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
&lt;!DOCTYPE HTML&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;title&gt;&lt;/title&gt;
&lt;link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" /&gt;
&lt;script src="http://code.jquery.com/jquery-1.9.1.min.js"&gt;&lt;/script&gt;
&lt;script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"&gt;&lt;/script&gt;
&lt;script src="https://www.google.com/jsapi"&gt;&lt;/script&gt;
&lt;script&gt;
$(document).on('pageshow','#index',function(){

    var innerAry = [];
    innerAry.push(['地域', '件数']);
    
    //データ取得
    $.getJSON("ramen.json",
        function(data){
            $.each(data['ラーメン']['地域'], function(key,val){
                    var i = 0;
                    $.each(val,function(key,val){
                        i++;
                    });
                    
                    var buff = [];
                    buff.push(key); //地域
                    buff.push(i);   //件数

                    //[地域,件数]のセットを格納
                    innerAry.push(buff);
            });

            google.load("visualization", "1", {"packages":["corechart"],"callback":drawChart});
        }
    );
    
    //グラフの描画
    function drawChart(){
        
        var outerAry = [];
        for(var i = 0; i &lt; innerAry.length; i++){
            outerAry.push(innerAry[i]);
        }
        
        var data = google.visualization.arrayToDataTable(outerAry);
        
        var options = {
            title:'ラーメン屋件数',
            vAxis:{title:'地域',titleTextStyle:{color:'#0000FF'}},
            chartArea:{height:"80%"}
        };
        var chart = new google.visualization.BarChart(document.getElementById('chart'));
        chart.draw(data, options);
    }

    //ウィンドウサイズ変更でグラフの再描画
    $(window).on('resize',function(){
        google.load("visualization", "1", {"packages":["corechart"],"callback":drawChart});
    });
});
&lt;/script&gt;
&lt;style&gt;
#chart{
    height:500px;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div data-role="page" id="index"&gt;
    &lt;div data-role="header"&gt;
        &lt;h1&gt;ラーメン屋件数&lt;/h1&gt;
    &lt;/div&gt;
    &lt;div data-role="content"&gt;
        &lt;div id="chart"&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div data-role="footer" data-position="fixed"&gt;
        &lt;h4&gt;Copyright &copy; ナカノヨウスケ&lt;/h4&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>


          </div>
          </div>
        </div>
      </div>
    </div>
    </div>

    <div id="footer"><%= title %></div>
 
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="js/google-code-prettify/prettify.js"></script>
    <script>prettyPrint();</script>
    <script src="js/bootstrap.min.js"></script>
    <script src="coffee/list-counter.js"></script>
  </body>
</html>