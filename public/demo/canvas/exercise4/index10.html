<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <style>
      #myCanvas{
       display:block;
      }
    </style>
  </head>
  <body>
    <canvas id="myCanvas" width="500" height="500"></canvas>
    <button id="startAnimation">Start</button>
    <button id="stopAnimation">Stop</button>
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script>
      $(function() {	
       //キャンバス要素　jQueryオブジェクト
       var canvas = $('#myCanvas');
       
       //2Dレンダリングコンテキスト
       var context = canvas.get(0).getContext('2d');
       
       var canvasWidth = canvas.width(); //キャンバス要素　幅
       var canvasHeight = canvas.height(); //キャンバス要素　高さ
       
       var playAnimation = true; //アニメーションフラグ　開始
       
       //スタート／ストップボタン　jQueryオブジェクト
       var startButton = $('#startAnimation');
       var stopButton = $('#stopAnimation');
       //スタートボタン初期表示削除
       startButton.hide();
       
       //スタートボタンクリック
       startButton.click(function(){
        $(this).hide(); //スタートボタン非表示
        stopButton.show(); //ストップボタン表示
        
        playAnimation = true; //アニメーションフラグ　開始
        animate(); //アニメーション開始
       });
       
       //ストップボタンクリック
       stopButton.click(function(){
        $(this).hide(); //ストップボタン非表示
        startButton.show(); //スタートボタン表示
        
        playAnimation = false; //アニメーションフラグ　停止
       });
       // Class that defines new shapes to draw
       var Shape = function(x, y, width, height) {
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
        this.radius = Math.random()*30;
        this.angle = 0;
       };
       // Array that holds all the shapes to draw
       var shapes = new Array();
       // Setting up some shapes
       for (var i = 0; i < 10; i++) {
        var x = Math.random()*250;
        var y = Math.random()*250;
        var width = height = Math.random()*30;
        shapes.push(new Shape(x, y, width, height));
       };
       // Animation loop that does all the fun stuff
       function animate() {
        // Clear
        context.clearRect(0, 0, canvasWidth, canvasHeight);
        // Loop through every object
        var shapesLength = shapes.length;
        for (var i = 0; i < shapesLength; i++) {
         var tmpShape = shapes[i];
         /*
         // Update					
         // Move each object 1 pixel to the right
         //tmpShape.x++;
         // Move each object 2 pixels to the right, and 1 pixel down
         //tmpShape.x += 2;
         //tmpShape.y++;
         // Move each object by a random amount
         //tmpShape.x += Math.random()*2-1;
         //tmpShape.y += Math.random()*2-1;						
         // Draw
         context.fillRect(tmpShape.x, tmpShape.y, tmpShape.width, tmpShape.height);
         */
         // Update
         // Circular orbit
         var x = tmpShape.x+(tmpShape.radius*Math.cos(tmpShape.angle*(Math.PI/180)));
         var y = tmpShape.y+(tmpShape.radius*Math.sin(tmpShape.angle*(Math.PI/180)));
         // Increase the angle on the circular orbit
         tmpShape.angle += 5;
         if (tmpShape.angle > 360) {
          tmpShape.angle = 0;	
         };					
         // Draw
         context.fillRect(x, y, tmpShape.width, tmpShape.height);
        };
        if (playAnimation) {
         // Run the animation loop again in 33 milliseconds
         setTimeout(animate, 33);
        };
       };
       // Start the animation loop
       animate();
      });
    </script>
  </body>
</html>